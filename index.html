<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Chat</title>

<style>
body{
  margin:0;
  font-family:Arial;
  background:linear-gradient(135deg,#000,#1a0033,#000);
  color:#fff;
}
.banner-online{
  background:linear-gradient(90deg,#ff0066,#ff00ff);
  text-align:center;
  padding:16px;
  font-size:22px;
  font-weight:bold;
  animation:parpadeo 1.2s infinite;
}
@keyframes parpadeo{0%{opacity:1}50%{opacity:.4}100%{opacity:1}}

.tabs{display:flex;justify-content:center;margin-top:10px}
.tab{
  padding:10px 18px;
  cursor:pointer;
  background:#111;
  border:1px solid #333;
  margin:0 4px;
  border-radius:10px;
  font-weight:bold;
}
.tab.active{background:#ff00ff}

.lista{
  max-width:420px;
  margin:10px auto;
  background:#000;
  border-radius:12px;
  padding:12px;
  display:none;
}
.lista div{
  padding:6px;
  border-bottom:1px solid #222;
}
.mujer{color:#ff66cc}
.hombre{color:#4da6ff}

.container{
  max-width:420px;
  margin:20px auto;
  background:rgba(0,0,0,.9);
  padding:20px;
  border-radius:16px;
  box-shadow:0 0 25px #ff00ff;
}
h2{text-align:center;color:#ff00ff}
input,select,button{
  width:100%;padding:12px;margin:6px 0;
  border:none;border-radius:8px;
}
input,select{background:#111;color:#fff;border:1px solid #333}
button{
  background:linear-gradient(90deg,#ff00ff,#ff0066);
  color:#fff;font-weight:bold;cursor:pointer;
}
#chat{display:none}
#mensajes{
  height:220px;overflow-y:auto;
  background:#000;border:1px solid #333;
  padding:10px;margin-bottom:8px;
}
.mensaje{margin-bottom:6px}
.regalo{color:#ffd700;font-weight:bold}
</style>
</head>

<body>

<div class="banner-online">
  ğŸ’ƒ MUJERES ONLINE: <span id="contadorMujeres">0</span>
</div>

<div class="tabs">
  <div class="tab active" onclick="verLista('mujeres')">ğŸ’ƒ Mujeres</div>
  <div class="tab" onclick="verLista('hombres')">ğŸ‘¨ Hombres</div>
</div>

<div class="lista" id="listaMujeres"></div>
<div class="lista" id="listaHombres"></div>

<div class="container" id="login">
  <h2>ğŸ”¥ REGISTRO ğŸ”¥</h2>
  <input id="email" placeholder="Correo electrÃ³nico">
  <input id="password" type="password" placeholder="ContraseÃ±a">
  <input id="nickRegistro" placeholder="Nick (visible)">
  <select id="tipo">
    <option value="">Selecciona</option>
    <option value="hombre">ğŸ‘¨ Hombre</option>
    <option value="mujer">ğŸ‘© Mujer</option>
  </select>
  <button onclick="registrar()">REGISTRARSE</button>
  <button onclick="loginUser()">ENTRAR</button>
</div>

<div class="container" id="chat">
  <h2>ğŸ’¬ CHAT</h2>

  ğŸ‘¤ <span id="infoUser"></span><br>
  ğŸ’° Monedas: <span id="monedas">0</span><br><br>

  <input id="nuevoNick" placeholder="Nuevo nick">
  <button onclick="cambiarNick()">CAMBIAR NICK</button><br><br>

  <div id="mensajes"></div>

  <input id="texto" placeholder="Mensaje">
  <button onclick="enviar()">ENVIAR</button>
  <button onclick="regalo()">ğŸ Enviar regalo (10)</button>
  <button onclick="salir()">SALIR</button>
</div>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<script>
const firebaseConfig={
  apiKey:"AIzaSyBszwdqJLY0GiPNlxh37_wNpSsIm0y9N0c",
  authDomain:"chat-1adf8.firebaseapp.com",
  projectId:"chat-1adf8"
};
firebase.initializeApp(firebaseConfig);
const auth=firebase.auth();
const db=firebase.firestore();

const listaM=document.getElementById("listaMujeres");
const listaH=document.getElementById("listaHombres");
const contador=document.getElementById("contadorMujeres");

db.collection("usuarios").onSnapshot(s=>{
  listaM.innerHTML="";listaH.innerHTML="";
  let c=0;
  s.forEach(d=>{
    const u=d.data();
    const div=document.createElement("div");
    div.textContent=u.nick;
    if(u.tipo==="mujer"){div.className="mujer";listaM.appendChild(div);c++;}
    else{div.className="hombre";listaH.appendChild(div);}
  });
  contador.innerText=c;
});

function verLista(t){
  document.querySelectorAll(".lista").forEach(l=>l.style.display="none");
  document.querySelectorAll(".tab").forEach(x=>x.classList.remove("active"));
  if(t==="mujeres"){listaM.style.display="block";document.querySelectorAll(".tab")[0].classList.add("active")}
  else{listaH.style.display="block";document.querySelectorAll(".tab")[1].classList.add("active")}
}
verLista("mujeres");

const email=document.getElementById("email");
const password=document.getElementById("password");
const nickR=document.getElementById("nickRegistro");
const tipoEl=document.getElementById("tipo");
const infoUser=document.getElementById("infoUser");
const monedasEl=document.getElementById("monedas");
const texto=document.getElementById("texto");
const mensajes=document.getElementById("mensajes");
const nuevoNick=document.getElementById("nuevoNick");

let usuario=null,tipo="",monedas=0,nick="";

function registrar(){
  if(!tipoEl.value||!nickR.value)return alert("Completa todo");
  auth.createUserWithEmailAndPassword(email.value,password.value)
  .then(c=>db.collection("usuarios").doc(c.user.uid).set({
    email:email.value,
    nick:nickR.value,
    tipo:tipoEl.value,
    monedas:tipoEl.value==="hombre"?100:0
  }));
}
function loginUser(){
  auth.signInWithEmailAndPassword(email.value,password.value);
}
auth.onAuthStateChanged(u=>{
  if(!u)return;
  usuario=u;
  db.collection("usuarios").doc(u.uid).get().then(doc=>{
    const d=doc.data();
    tipo=d.tipo;monedas=d.monedas;nick=d.nick;
    infoUser.innerText=nick+" ("+tipo+")";
